---
import { Image } from "astro:assets"
import footerBackground from "../../assets/footer_background.webp"
---

<section id="cta-section" class="relative border-t border-surface-border-muted px-6 py-24 overflow-hidden">
  <div class="absolute inset-0 -z-10">
    <Image src={footerBackground} alt="" class="absolute inset-0 h-full w-full object-cover opacity-40" style="object-position: center 70%;" loading="lazy" widths={[640, 1280, 1920]} sizes="100vw" />
    <div class="absolute inset-0 bg-gradient-to-b from-surface-bg/70 via-surface-bg/50 to-surface-bg"></div>
  </div>
  <div class="mx-auto max-w-5xl text-center relative">
    <p class="text-sm text-gray-500 mb-4">Ready?</p>
    <h2 class="cta-heading text-3xl font-semibold tracking-tight text-white md:text-4xl">
      <span class="cta-quote">"Hey AI, let's get started."</span><span class="cta-cursor"></span>
    </h2>
    <p class="mx-auto mt-6 max-w-lg text-base text-gray-400">
      Deploy your first AI agent in minutes. Free to start, open source forever.
    </p>
    <div class="mt-10 flex flex-wrap items-center justify-center gap-4">
      <a href="https://synatrahq.com/login" class="inline-flex items-center rounded-full bg-white px-8 py-3 text-sm font-medium text-gray-950 transition-all hover:bg-gray-200 hover:scale-105 shadow-lg shadow-white/10">
        Start for free
      </a>
      <a href="/docs" class="inline-flex items-center rounded-full border border-surface-border bg-surface-bg-elevated/50 backdrop-blur-sm px-8 py-3 text-sm font-medium text-gray-300 transition-all hover:border-gray-600 hover:text-white">
        Read the docs
      </a>
    </div>
    <p class="mt-6 text-xs text-gray-600">
      Open source. Self-host or use our cloud.
    </p>
  </div>
</section>

<style>
  .cta-cursor {
    display: inline-block;
    width: 3px;
    height: 0.9em;
    background: rgb(16 185 129);
    margin-left: 4px;
    vertical-align: text-bottom;
    animation: cta-blink 1s step-end infinite;
    box-shadow: 0 0 8px rgb(16 185 129 / 0.5);
  }

  @keyframes cta-blink {
    50% { opacity: 0; }
  }

  .cta-quote {
    opacity: 0;
  }

  .cta-quote.is-typed {
    opacity: 1;
  }

  @media (prefers-reduced-motion: reduce) {
    .cta-cursor {
      animation: none;
      opacity: 1;
    }
    .cta-quote {
      opacity: 1;
    }
  }
</style>

<script>
  const section = document.getElementById("cta-section")
  const quote = section?.querySelector(".cta-quote") as HTMLElement
  const cursor = section?.querySelector(".cta-cursor") as HTMLElement

  if (quote && cursor && !window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
    const text = quote.textContent || ""
    let hasPlayed = false

    const typeText = () => {
      if (hasPlayed) return
      hasPlayed = true

      quote.textContent = ""
      quote.classList.add("is-typed")
      let i = 0

      const type = () => {
        if (i < text.length) {
          quote.textContent = text.slice(0, i + 1)
          i++
          setTimeout(type, 40 + Math.random() * 30)
        }
      }
      type()
    }

    const observer = new IntersectionObserver(
      (entries) => {
        if (entries[0].isIntersecting) {
          typeText()
          observer.disconnect()
        }
      },
      { threshold: 0.6 }
    )

    observer.observe(section!)
  } else if (quote) {
    quote.classList.add("is-typed")
  }
</script>
